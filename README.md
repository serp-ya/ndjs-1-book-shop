# Домашнее задание к занятию «2.1 Express»

### Установка и запуск
Для запуска проекта необходимо:
- Склонировать репозиторий
- Установить модули `npm i`
- Добавить файл `.env`
- Определить переменную `APP_PORT` с удобным портом
- Запустить сервер `npm run start:watch`

#### Предисловие
Начиная с данного блока, в домашних работах вы будете разрабатывать приложение «библиотека». С каждым последующим заданием функционал приложения будет расширяться.

#### Задание 1
Обновить структуру роутинга проекта с использованием **express.Router()**.

#### Решение задания 1
Эта задача была решена ешё случайно в предыдущей работе, я изначально использовал **express.Router()**

#### Задание 2
Установить в проект пакет [**multer**](https://github.com/expressjs/multer/blob/master/doc/README-ru.md)
и создать middleware для загрузки файла книги. 
Созданную Middleware подключить и обработать в роутах создания данных о книге

#### Решение задания 2
С этим заданием пришлось повозиться, но проблема была не в сложности настройки `multer`, а в том, что этот пакет не дружит ни с одним из миддлвари, которые занимаются парсингом значений `form-data` на уровне всего приложения и проявляет довольно таки странное поведение на разных узлах...

В рамках решения этой задачи были [заданы вопросы разработчикам на github](https://github.com/expressjs/multer/issues/952)

Сейчас приложение корректно обрабатывает заданный ранее контракт, но пришлось исключить из `post`/`put` запросов поле `key`, которое нарушает этот самый контракт. Входящие файлы корректно обрабатываются и сохраняются в директорию `public/books`. В запись новой книги сохраняется оригинальный `fileName` входящего файла. При сохранении имени файла, в записи книги остаётся простое имя, а в директорию на сервере сохраняется имя файла с `md5` хеш суммой некоторых значений из записи книги в начале.

Так же, добавил в приложение корректную отдачу статичных ресурсов.

#### Задание 3
Создать роут `GET: /api/books/:id/download` 
Метод отдает на скачиваение файл книги по ее **:id**

#### Решение задания 2
Скачивание файла происходит корректно без особых тонкостей